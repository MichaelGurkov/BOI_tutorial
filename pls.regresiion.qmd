---
title: "Partial least squares"
---

```{r}

library(tidymodels)

library(tidyverse)

library(plsmod)

```

```{r load_data}

boston_data = MASS::Boston

```

```{r split_data}

data_split = initial_split(boston_data, prop = 0.5)

train_set = training(data_split)

test_set = testing(data_split)

```


```{r model_spec}

preprocess_rec = recipe(medv ~ ., data = train_set) %>% 
  step_normalize(all_numeric_predictors())

pls_reg = pls(mode = "regression", num_comp = 3)


pls_fit = workflow() %>% 
  add_recipe(preprocess_rec) %>% 
  add_model(pls_reg) %>% 
  fit(train_set)

```

```{r predictions}

pls_fit %>% 
  predict(test_set)

```

